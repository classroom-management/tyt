/**
 * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, http://github.com/requirejs/almond/LICENSE
 */

!function(){var t,e,i;!function(n){function s(t,e){return E.call(t,e)}function o(t,e){var i,n,s,o,r,a,c,l,h,u,d,p,m=e&&e.split("/"),b=v.map,f=b&&b["*"]||{};if(t){for(t=t.split("/"),r=t.length-1,v.nodeIdCompat&&L.test(t[r])&&(t[r]=t[r].replace(L,"")),"."===t[0].charAt(0)&&m&&(p=m.slice(0,m.length-1),t=p.concat(t)),h=0;h<t.length;h++)if("."===(d=t[h]))t.splice(h,1),h-=1;else if(".."===d){if(0===h||1===h&&".."===t[2]||".."===t[h-1])continue;h>0&&(t.splice(h-1,2),h-=2)}t=t.join("/")}if((m||f)&&b){for(i=t.split("/"),h=i.length;h>0;h-=1){if(n=i.slice(0,h).join("/"),m)for(u=m.length;u>0;u-=1)if((s=b[m.slice(0,u).join("/")])&&(s=s[n])){o=s,a=h;break}if(o)break;!c&&f&&f[n]&&(c=f[n],l=h)}!o&&c&&(o=c,a=l),o&&(i.splice(0,a,o),t=i.join("/"))}return t}function r(t,e){return function(){var i=S.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),m.apply(n,i.concat([t,e]))}}function a(t){return function(e){return o(e,t)}}function c(t){return function(e){y[t]=e}}function l(t){if(s(g,t)){var e=g[t];delete g[t],w[t]=!0,p.apply(n,e)}if(!s(y,t)&&!s(w,t))throw new Error("No "+t);return y[t]}function h(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function u(t){return t?h(t):[]}function d(t){return function(){return v&&v.config&&v.config[t]||{}}}var p,m,b,f,y={},g={},v={},w={},E=Object.prototype.hasOwnProperty,S=[].slice,L=/\.js$/;b=function(t,e){var i,n=h(t),s=n[0],r=e[1];return t=n[1],s&&(s=o(s,r),i=l(s)),s?t=i&&i.normalize?i.normalize(t,a(r)):o(t,r):(t=o(t,r),n=h(t),s=n[0],t=n[1],s&&(i=l(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:i}},f={require:function(t){return r(t)},exports:function(t){var e=y[t];return void 0!==e?e:y[t]={}},module:function(t){return{id:t,uri:"",exports:y[t],config:d(t)}}},p=function(t,e,i,o){var a,h,d,p,m,v,E,S=[],L=typeof i;if(o=o||t,v=u(o),"undefined"===L||"function"===L){for(e=!e.length&&i.length?["require","exports","module"]:e,m=0;m<e.length;m+=1)if(p=b(e[m],v),"require"===(h=p.f))S[m]=f.require(t);else if("exports"===h)S[m]=f.exports(t),E=!0;else if("module"===h)a=S[m]=f.module(t);else if(s(y,h)||s(g,h)||s(w,h))S[m]=l(h);else{if(!p.p)throw new Error(t+" missing "+h);p.p.load(p.n,r(o,!0),c(h),{}),S[m]=y[h]}d=i?i.apply(y[t],S):void 0,t&&(a&&a.exports!==n&&a.exports!==y[t]?y[t]=a.exports:d===n&&E||(y[t]=d))}else t&&(y[t]=i)},t=e=m=function(t,e,i,s,o){if("string"==typeof t)return f[t]?f[t](e):l(b(t,u(e)).f);if(!t.splice){if(v=t,v.deps&&m(v.deps,v.callback),!e)return;e.splice?(t=e,e=i,i=null):t=n}return e=e||function(){},"function"==typeof i&&(i=s,s=o),s?p(n,t,e,i):setTimeout(function(){p(n,t,e,i)},4),m},m.config=function(t){return m(t)},t._defined=y,i=function(t,e,i){if("string"!=typeof t)throw new Error("See almond README: incorrect module build, no module name");e.splice||(i=e,e=[]),s(y,t)||s(g,t)||(g[t]=[t,e,i])},i.amd={jQuery:!0}}(),i("libs/almond",function(){}),i("rs/three/BaseApp",[],function(){"use strict";function t(t,e,i){this.width=t||1e3,this.height=e||600,this.fov=i||60,this.init()}return t.prototype.init=function(){this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(this.fov,this.width/this.height,10,2e4);var t=this.renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0,preserveDrawingBuffer:!0});t.setSize(this.width,this.height),t.setPixelRatio(window.devicePixelRatio),this.camera.lookAt(new THREE.Vector3(0,0,0)),this.el=t.domElement,this.raycaster=new THREE.Raycaster},t.prototype._renderRequest=function(t){this.renderer.render(this.scene,this.camera),this.rId=requestAnimationFrame(this._renderRequest.bind(this))},t.prototype.startRendering=function(){this.stopRendering(),this.rId=requestAnimationFrame(this._renderRequest.bind(this))},t.prototype.stopRendering=function(){cancelAnimationFrame(this.rId)},t.prototype.resizeHandler=function(){this.thfov=Math.tan(this.camera.fov*Math.PI/360)},t.prototype.setCameraMatchProjection=function(t){t=t||1;var e=this.camera,i=.5*this.height/Math.tan(e.fov*Math.PI/360);e.position.x=e.position.y=0,e.position.z=i/t,e.lookAt(new THREE.Vector3(0,0,0))},t.prototype._getScaleFitRatio=function(t,e,i){i=i||.75;var n=t/e;return this.width/n>this.height?this.height*i/e:this.width*i/t},t.prototype.getScaleFitPositionZ=function(t,e,i){this.setCameraMatchProjection();var n=this._getScaleFitRatio(t,e,i),s=this.camera.position.z;return s-s/n},t}),i("rs/bb3d/Preferences",[],function(){"use strict";function t(t,e){this.dataString=e,this.config=t,this.init(e)}return t.prototype.init=function(t){null==t?(this.data={name:"bb3d",blockData:{},swatches:["#ffe048"]},this.save()):this.data=JSON.parse(t)},t.prototype.save=function(){null!=this.data&&localStorage.setItem("bb3d",JSON.stringify(this.data))},t.prototype.saveBlockData=function(t){this.data.blockData=t},t}),i("rs/bb3d/AssetManager",[],function(){"use strict";function t(t){this.bb3d=t,this.init()}return t.prototype.init=function(){var t=this.loadingManager=new THREE.LoadingManager,e=this;t.onLoad=function(){e.loaded=!0,console.log("Assets loaded"),e.onLoad&&e.onLoad.call(e)},t.onProgress=function(t,i,n){e.onProgress&&e.onProgress.call(e,t,i,n)},this.soundOn=!0},t.prototype.load=function(){this.loadAudio(),this.loadTextureAtlas()},t.prototype.loadAudio=function(){function t(t,n){var s=new THREE.Audio(i);return new THREE.AudioLoader(e.loadingManager).load(t,function(t){s.setBuffer(t),n&&n.call(e)}),s}var e=this,i=new THREE.AudioListener;this.bb3d.config.general.useBackgroundMusic&&(this.bgSound=t("https://cdn.jsdelivr.net/gh/classroom-management/tyt@main/sounds/bg.mp3",function(){this.bgSound.setLoop(!0)})),this.btnClick=t("https://cdn.jsdelivr.net/gh/classroom-management/tyt@main/sounds/btnClick.mp3"),this.popSound=t("https://cdn.jsdelivr.net/gh/classroom-management/tyt@main/sounds/pop.mp3"),this.breakSound=t("https://cdn.jsdelivr.net/gh/classroom-management/tyt@main/sounds/break.mp3"),this.scaleUp=t("https://cdn.jsdelivr.net/gh/classroom-management/tyt@main/sounds/scaleup.mp3"),this.scaleDown=t("https://cdn.jsdelivr.net/gh/classroom-management/tyt@main/sounds/scaledown.mp3"),this.error=t("https://cdn.jsdelivr.net/gh/classroom-management/tyt@main/sounds/error.mp3")},t.prototype.loadTextureAtlas=function(){function t(){var t=e.atlasData.frames;e.textures=[];var i=e.atlasTex.image.width,n=e.atlasTex.image.height;for(var s in t){var o=t[s].frame,r=e.atlasTex.clone();r.repeat.set(.124,.124),o.x+=.45,o.y+=.45,r.offset.x=o.x/i,r.offset.y=1-o.h/n-o.y/n,r.needsUpdate=!0,e.textures.push({key:s.replace("/","-"),tex:r})}}var e=this;new THREE.FileLoader(e.loadingManager).load("https://cdn.jsdelivr.net/gh/classroom-management/tyt@main/atlas.json",function(i){e.atlasData=JSON.parse(i),e.atlasTex&&t()}),new THREE.TextureLoader(e.loadingManager).load("https://cdn.jsdelivr.net/gh/classroom-management/tyt@main/atlas.jpg",function(i){e.atlasTex=i,e.atlasData&&t()})},t.prototype.toggleSound=function(){this.soundOn=!this.soundOn,this.soundOn?(this.bgSound&&this.bgSound.setVolume(.8),this.btnClick.setVolume(1),this.popSound.setVolume(1),this.breakSound.setVolume(1),this.scaleUp.setVolume(1),this.scaleDown.setVolume(1),this.error.setVolume(1)):(this.bgSound&&this.bgSound.setVolume(0),this.btnClick.setVolume(0),this.popSound.setVolume(0),this.breakSound.setVolume(0),this.scaleUp.setVolume(0),this.scaleDown.setVolume(0),this.error.setVolume(0))},t}),i("rs/bb3d/ui/HomeScreenHeader",[],function(){"use strict";function t(t){this.hs=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-hscreen-header";var e=this.hs.config;this.title=document.createElement("h1"),this.title.className="app-title",this.title.innerHTML=e.strings.APP_TITLE,t.appendChild(this.title),this.info=document.createElement("span"),this.info.className="app-info",this.info.innerHTML=e.strings.APP_INFO,t.appendChild(this.info),this.progress=document.createElement("div"),this.progress.className="app-progress",this.progressInner=document.createElement("div"),this.progressInner.className="app-progress-inner",t.appendChild(this.progress),this.progress.appendChild(this.progressInner),this.setProgress(0),this.logo=document.createElement("img"),this.logo.className="app-logo",this.logo.src="https://cdn.jsdelivr.net/gh/classroom-management/tyt@main/graphics/logo.png",this.logo.onmousedown=function(t){t.preventDefault()},t.appendChild(this.logo)},t.prototype.hideProgress=function(){var t=this.progress;anime({targets:t,opacity:0,easing:"easeOutQuint",complete:function(){t.style.display="none"}})},t.prototype.hideLogo=function(){var t=this.logo,e=this.hs.bb3d.isMobile;anime({targets:t,opacity:0,easing:"easeOutQuint",complete:function(){if(e)return void(t.style.display="none");anime.remove(t),anime({targets:t,width:32,marginTop:20,opacity:1})}})},t.prototype.setProgress=function(t){this.progressInner.style.width=t+"%"},t.prototype.moveTop=function(){this.hideProgress(),this.hideLogo(),anime.remove(this.el),anime({targets:this.el,top:0,translateY:0,easing:"easeOutQuint",duration:1200})},t.prototype.center=function(){var t=this.hs.bb3d.assetManager,e=this.el;anime({targets:this.el,top:"50%",translateY:"-50%",duration:1400,update:function(){t.showDelay&&(anime.remove(e),anime({targets:e,top:0,translateY:0,duration:0}))}})},t}),i("rs/bb3d/ui/HomeScreenMenu",[],function(){"use strict";function t(t){this.hs=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-hscreenmenu",this.con=document.createElement("div"),this.con.className="menu-list",t.appendChild(this.con);var e=this.hs.config,i=this.hs;this.addItem(e.strings.NEW_GAME,function(){i.startNewGame()}),e.general.useHelpPanel&&this.addItem(e.strings.HELP,function(){i.showHelp()}),e.general.useCreditPanel&&this.addItem(e.strings.CREDIT,function(){i.showCredit()})},t.prototype.addItem=function(t,e){var i=document.createElement("div");i.className="menu-item",i.innerHTML=t,i.style.opacity=0,this.con.appendChild(i);var n=this.hs.bb3d.assetManager;i.addEventListener("click",function(t){e&&e.call(this),n.btnClick.play()})},t.prototype.show=function(){anime({targets:".rs-hscreenmenu .menu-item",opacity:1,easing:"easeOutQuad",delay:anime.stagger(150,{start:500})})},t}),i("rs/game/BasePanel",[],function(){"use strict";function t(t,e){this.width=t||300,this.height=e||300,this.init()}return t.prototype.init=function(){(this.ol=document.createElement("div")).className="rs-game-overlay";var t=this.el=document.createElement("div");t.className="rs-game-panel",t.style.width=this.width+"px",t.style.height=this.height+"px";var e=this.closeBtn=document.createElement("span");e.className="rs-closebtn",e.innerHTML="&times",t.appendChild(e),e.addEventListener("click",this.hide.bind(this))},t.prototype.show=function(){document.body.appendChild(this.ol),document.body.appendChild(this.el),anime.remove(this.el),anime({targets:this.el,opacity:[0,1],duration:800,easing:"easeOutQuint"})},t.prototype.hide=function(){document.body.contains(this.ol)&&document.body.removeChild(this.ol),document.body.contains(this.el)&&document.body.removeChild(this.el)},t.prototype.resize=function(t,e){},t}),i("rs/game/OptionPanel",["rs/game/BasePanel"],function(t){"use strict";function e(e,i){this.data=e,this.callback=i,t.prototype.constructor.call(this)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.init=function(){function e(t){var e=t.currentTarget.index;n.callback&&n.callback.call(n,e),n.hide()}t.prototype.init.call(this);var i=this.el;i.classList.add("rs-game-optionpanel"),i.style.height="auto";for(var n=this,s=0;s<this.data.length;s++){var o=document.createElement("div");o.className="rs-optionitem",o.innerHTML=this.data[s],o.index=s,o.addEventListener("click",e),i.appendChild(o)}},e}),i("rs/bb3d/ui/SettingPanel",["rs/game/OptionPanel","rs/game/BasePanel"],function(t,e){"use strict";function i(t){this.bb3d=t,this.config=t.config,e.prototype.constructor.call(this)}i.prototype=Object.create(e.prototype),i.prototype.constructor=i;return i.prototype.init=function(){e.prototype.init.call(this);var i=this.el;i.classList.add("rs-bb3d-spanel"),i.style.width="90%",i.style.height="auto",this.settings={difficulty:"EASY",defaultCategory:0};var n=this.container=document.createElement("div");n.className="rs-settingcontainer",i.appendChild(n);var s=this.config.data.level,o=[];for(var r in s)o.push(r);this.cat=o;var a=this,c=this.bb3d.assetManager,l=this.depanel=new t(o,function(t){a.bb3d.pref.saveDefaultCategory(t),a.updateSettingItem(),c.btnClick.play()}),h=this.dpanel=new t(["EASY","NORMAL","HARD"],function(t){a.bb3d.pref.saveDifficulty(t),a.updateSettingItem(),c.btnClick.play()});this.sitem1=this.buildSettingItem("Difficulty",h),this.sitem2=this.buildSettingItem("Default Category",l)},i.prototype.buildSettingItem=function(t,e){var i=this.bb3d.assetManager,n=document.createElement("div");n.className="rs-settingitem";var s=document.createElement("h3");s.innerHTML=t,n.title=s,n.appendChild(s);var o=document.createElement("span");return o.innerHTML="Button",n.btn=o,n.appendChild(o),this.container.appendChild(n),o.addEventListener("click",function(t){e.show(),i.btnClick.play()}),n},i.prototype.show=function(){e.prototype.show.call(this),this.updateSettingItem()},i.prototype.updateSettingItem=function(){var t=this.bb3d.pref,e=["EASY","NORMAL","HARD"];this.sitem1.btn.innerHTML=e[t.data.difficulty],this.sitem2.btn.innerHTML=this.cat[t.data.defaultCategory].toUpperCase()},i}),i("rs/utils/BrowserUtil",[],function(){"use strict";var t={bp:{XS:0,SM:576,MD:768,LG:992,XL:1200,XXL:1500,X3L:1900,X4L:2e3,X5L:3e3},computeStyle:function(t,e,i){return void 0===i&&(i="px"),parseFloat(getComputedStyle(t)[e].replace(i,""))},css:function(t,e){for(var i in e)t.style[i]=e[i]},getPrefix:function(){return t.pf||(window.opera||navigator.userAgent.indexOf(" OPR/")>=0?(t.pf="Webkit",t.browserName="Opera"):"undefined"!=typeof InstallTrigger?(t.pf="Moz",t.browserName="Firefox"):window.safari?(t.pf="Webkit",t.browserName="Safari"):window.chrome?(t.pf="Webkit",t.browserName="Chrome"):document.documentMode?(t.pf="ms",t.browserName="MSIE"):/Edge/.test(navigator.userAgent)?(t.pf="ms",t.browserName="MSIE"):(t.pf="Webkit",t.browserName="Safari"),"Webkit"===t.pf?t.ps="":t.ps="px",""!==t.pf?t.csspf="-"+t.pf.toLowerCase()+"-":t.csspf="",console.log(t.pf)),t.pf},getMouseTouchEvents:function(){return this.isMobile()?{mdown:"touchstart",mmove:"touchmove",mup:"touchend"}:{mdown:"mousedown",mmove:"mousemove",mup:"mouseup"}},isMobile:function(){return void 0===t.imb&&(t.imb=null===document.createElement("span").ontouchstart),t.imb},goFullscreen:function(e){var i=t.isFullscreenSupported();return!!i&&(""===i?e.requestFullScreen():e[i+"RequestFullScreen"]())},exitFullscreen:function(e){var i=t.isFullscreenSupported();return!!i&&(!!t.isFullscreen()&&(""===i?document.cancelFullScreen():document[i+"CancelFullScreen"]()))},fullScreenCallback:function(e,i,n){var s=t.isFullscreenSupported();if(!s)return!1;var o=s+"fullscreenchange";document.addEventListener(o,i)},isFullscreen:function(){var e=t.isFullscreenSupported();if(!e)return!1;switch(e){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[e+"FullScreen"]}},isFullscreenSupported:function(){var e=t.pf.toLowerCase();return void 0!==document.cancelFullScreen?"":void 0!==document[e+"CancelFullScreen"]&&e}};return t}),i("rs/game/Scroller",["rs/utils/BrowserUtil"],function(t){"use strict";function e(e){t.isMobile()?(i="touchstart",n="touchend",s="touchmove"):(i="mousedown",n="mouseup",s="mousemove"),this.el=e,this.el.style.overflow="hidden",this.init()}var i,n,s;return e.prototype.init=function(){function t(){u.scrollTop+=.075*(l-u.scrollTop),d.scrollId=requestAnimationFrame(t)}function e(e){h=e.touches?e.touches[0].clientY:e.clientY,a=h,c=l=u.scrollTop,u.addEventListener(s,o),u.addEventListener(n,r),window.addEventListener(s,o),window.addEventListener(n,r),cancelAnimationFrame(d.scrollId),d.scrollId=requestAnimationFrame(t),u.style.cursor="grab"}function o(t){h=t.changedTouches?t.changedTouches[0].clientY:t.clientY;var e=2.5*(h-a),i=u.scrollHeight-d.el.clientHeight,n=c-e;n>i&&(n=i),n<0&&(n=0),l=n,u.style.cursor="grabbing"}function r(t){u.removeEventListener(s,o),u.removeEventListener(n,r),window.removeEventListener(s,o),window.removeEventListener(n,r),cancelAnimationFrame(d.scrollId),u.style.cursor="grab"}var a,c,l,h,u=this.el,d=this;u.addEventListener(i,e),u.addEventListener("mouseover",function(t){u.style.cursor="grab"})},e}),i("rs/bb3d/ui/HelpPanel",["rs/game/Scroller","rs/game/BasePanel"],function(t,e){"use strict";function i(){e.prototype.constructor.call(this)}i.prototype=Object.create(e.prototype),i.prototype.constructor=i;return i.prototype.init=function(){e.prototype.init.call(this);var i=this.el;i.classList.add("rs-bb3d-helppanel"),i.style.width=i.style.height="90%";var n=this.container=document.createElement("div");n.className="rs-helpcontainer",i.appendChild(n),this.scroller=new t(this.container);var s=new XMLHttpRequest;s.addEventListener("load",function(t){var e=this.responseText;n.innerHTML=e}),s.open("GET","https://cdn.jsdelivr.net/gh/classroom-management/tyt@main/text/helpcontent.html"),s.send()},i}),i("rs/bb3d/ui/CreditPanel",["rs/game/BasePanel"],function(t){"use strict";function e(e){this.bb3d=e,t.prototype.constructor.call(this)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.init=function(){t.prototype.init.call(this);var e=this.el;e.classList.add("rs-bb3d-cpanel"),e.style.width="90%",e.style.height="auto";var i=this.content=document.createElement("div"),n=this.bb3d.config.strings;i.innerHTML="<h3>"+n.APP_TITLE+"</h3>",i.innerHTML+="<p>"+n.CREDIT_TEXT+"</p>",e.appendChild(i)},e}),i("rs/bb3d/screen/HomeScreen",["rs/bb3d/ui/HomeScreenHeader","rs/bb3d/ui/HomeScreenMenu","rs/bb3d/ui/SettingPanel","rs/bb3d/ui/HelpPanel","rs/bb3d/ui/CreditPanel"],function(t,e,i,n,s){"use strict";function o(t){this.bb3d=t,this.loaded=!1,this.config=t.config,this.init()}return o.prototype.init=function(){var i=this.el=document.createElement("div");i.className="rs-hscreen",i.style.width=i.style.height="100%",i.style.display="none",this.header=new t(this),this.menu=new e(this),this.hpanel=new n,this.cpanel=new s(this.bb3d)},o.prototype.load=function(){this.el.style.display="block",this.el.appendChild(this.header.el),this.header.center();var t=this.bb3d.assetManager,e=this,i=this.header,n=this.menu;t.onLoad=function(){setTimeout(function(){t.showDelay=!0,i.moveTop(),e.el.appendChild(n.el),n.show(),t.bgSound&&t.bgSound.play()},1500)},t.onProgress=function(t,i,n){e.header.setProgress(i/n*100)},this.bb3d.assetManager.load()},o.prototype.transitionIn=function(){this.el.style.display="block",anime({targets:this.el,translateY:0,easing:"easeOutQuint",opacity:1,duration:1200})},o.prototype.transitionOut=function(){var t=this.el;anime({targets:this.el,translateY:-400,easing:"easeOutQuint",opacity:0,duration:1200,complete:function(){t.style.display="none"}})},o.prototype.show=function(){if(this.bb3d.root.appendChild(this.el),!this.bb3d.assetManager.loaded)return void this.load();this.transitionIn()},o.prototype.hide=function(){this.bb3d.root.removeChild(this.el),this.transitionOut()},o.prototype.startNewGame=function(){this.bb3d.setGameScreen()},o.prototype.showSetting=function(){this.spanel.show()},o.prototype.showHelp=function(){this.hpanel.show()},o.prototype.showCredit=function(){this.cpanel.show()},o.prototype.resize=function(t,e){},o}),i("rs/game/ImagePanel",["rs/game/BasePanel"],function(t){"use strict";function e(){t.prototype.constructor.call(this)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.init=function(){t.prototype.init.call(this),this.el.classList.add("rs-image-panel");var e=this.img=document.createElement("img");this.el.appendChild(this.img),this.el.style.width=this.el.style.height="auto",e.addEventListener("click",this.hide.bind(this)),e.onload=function(t){var i=e.naturalWidth/e.naturalHeight;e.naturalHeight>=window.innerHeight&&(e.height=.85*window.innerHeight,e.width=e.height*i),e.naturalWidth>=window.innerWidth&&(e.width=.85*window.innerWidth,e.height=e.width/i)}},e.prototype.show=function(e){this.img.src=e,t.prototype.show.call(this)},e}),i("rs/bb3d/ui/InfoModal",[],function(){"use strict";function t(){this.init()}return t.prototype.init=function(){(this.el=document.createElement("div")).className="rs-bb3d-infomodal"},t.prototype.show=function(t){var e=this;document.body.appendChild(this.el),this.el.style.opacity=1,this.el.innerHTML=t,anime.remove(this.el),anime({targets:this.el,opacity:0,easing:"easeOutQuint",delay:800,complete:function(){e.hide()}})},t.prototype.hide=function(){document.body.removeChild(this.el)},t}),i("rs/bb3d/ui/ColorPatternPanel",["rs/game/Scroller","rs/game/BasePanel"],function(t,e){"use strict";function i(t){this.gs=t,this.am=t.bb3d.assetManager,e.prototype.constructor.call(this)}return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype.init=function(){e.prototype.init.call(this);var i=this.el;this.el.classList.add("rs-bb3d-colorpatternpanel"),i.style.width=i.style.height="90%",this.buildFilter();var n=this.lgc=document.createElement("div");n.className="rs-bb3d-colorpatterncontainer",i.appendChild(n),this.lg=document.createElement("div"),this.lg.className="rs-bb3d-colorpattern",n.appendChild(this.lg),this.scroller=new t(this.lgc),this.pref=this.gs.bb3d.pref,this.swatches=this.pref.data.swatches,this.sc=document.createElement("div"),this.sc.className="rs-swatchcontainer"},i.prototype.buildFilter=function(){function t(t){i&&i.classList.remove("rs-active-filteritem");var e=t.currentTarget;n.applyFilter(e.innerHTML),e.classList.add("rs-active-filteritem"),i=e}function e(e){var i=document.createElement("div");return i.className="rs-filteritem",i.innerHTML=e,i.addEventListener("click",t),o.appendChild(i),i}var i,n=this,s=this.el,o=this.filer=document.createElement("div");o.className="rs-patternfilter",s.appendChild(o),e("Color"),e("Brick"),e("Grass"),e("Soil"),e("Stone"),e("Water"),e("Wood"),i=o.firstChild,i.classList.add("rs-active-filteritem")},i.prototype.applyFilter=function(t){function e(t){n.selectSwatchColor(t.currentTarget.cvalue)}var t=t.toLowerCase(),i=this.lg.children,n=this;if(this.currentLabel=t,"color"!=t)for(var s=0;s<i.length;s++){var o=i[s];o.className.indexOf(t)<0?o.style.display="none":o.style.display="block"}else{this.lg.firstChild.style.display="block",this.sc.textContent="",this.sc.appendChild(this.ip);for(var s=0;s<this.swatches.length;s++){var r=this.swatches[s],a=document.createElement("div");a.className="rs-swatchitem",a.style.backgroundColor=r,a.cvalue=r,a.addEventListener("click",e),this.sc.appendChild(a)}for(var s=1;s<i.length;s++){var o=i[s];o.style.display="none"}}},i.prototype.addSwatchColor=function(t){this.swatches.push(t),this.pref.save()},i.prototype.selectSwatchColor=function(t){this.ip.value=t,this.hide(),this.am.btnClick.play(),this.gs.header.cp.setColor(t),this.gs.game3d.actionState.setTexture(parseInt(t.replace("#","0x")),null)},i.prototype.buildGrid=function(){function t(t){var n=t.currentTarget.index,s=i.game3d.actionState;i.bb3d.assetManager.btnClick.play(),r.hide();var o=e.textures[n].tex,c=e.textures[n].key;s.setTexture(o,c),a.setPattern(c)}if(!this.lg.firstChild){var e=this.am,i=this.gs,n=e.textures,s=e.textures.length,o=this.lg,r=this,a=i.header.cp,c=this.ip=document.createElement("input");c.type="color",c.value="#ffe048",c.className="rs-inputcolor",this.sc.appendChild(c),o.appendChild(this.sc),c.addEventListener("change",function(t){var e=i.game3d.actionState;i.bb3d.assetManager.btnClick.play(),r.hide(),r.addSwatchColor(c.value),a.setColor(c.value),e.setTexture(parseInt(c.value.replace("#","0x")),null)});for(var l=0;l<s;l++){var h=document.createElement("div");h.className="rs-bb3d-colorpatternitem",h.classList.add(n[l].key),h.index=l,o.appendChild(h),h.addEventListener("click",t)}cancelAnimationFrame(this.scrollId),this.lgc.scrollTop=0;var u=96*Math.floor(this.lg.clientWidth/96);this.lg.style.width=u+"px",this.applyFilter("color")}},i.prototype.show=function(){e.prototype.show.call(this),this.buildGrid(),this.applyFilter(this.currentLabel)},i.prototype.hide=function(){e.prototype.hide.call(this)},i}),i("rs/bb3d/ui/BoardPanel",["rs/game/BasePanel"],function(t){"use strict";function e(e){this.gs=e,t.prototype.constructor.call(this)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.init=function(){function e(t){o.bb3d.assetManager.btnClick.play();var e=s[t.currentTarget.index];o.game3d.loadCustomLevel(e[0],e[1]),r.hide()}t.prototype.init.call(this);var i=this.el;i.classList.add("rs-bb3d-categorypanel"),i.style.width=i.style.height="auto",this.title=document.createElement("h1"),this.title.className="trophy-level-title",this.title.innerHTML="Board Pieces";var n=["6 pieces","24 pieces","96 pieces"],s=[[2,3],[4,6],[8,12]],o=this.gs;this.list=[];for(var r=this,a=0;a<n.length;a++){var c=document.createElement("div");c.className="rs-categoryitem",c.innerHTML=n[a],c.index=a,c.addEventListener("click",e),this.list.push(c),i.appendChild(c)}},e.prototype.show=function(){t.prototype.show.call(this),document.body.appendChild(this.title)},e.prototype.hide=function(){t.prototype.hide.call(this),document.body.contains(this.title)&&document.body.removeChild(this.title)},e}),i("rs/game/IconButton",["rs/utils/BrowserUtil"],function(t){"use strict";function e(t,e){this.init(t,e)}return e.prototype.init=function(e,i){var n=this.el=document.createElement("span");n.className=e,t.css(n,{display:"block",cursor:"pointer",borderRadius:"50%",textAlign:"center"});var s=this;i&&n.addEventListener("click",function(t){i.call(s)})},e}),i("rs/bb3d/ui/GameButton",["rs/game/IconButton"],function(t){"use strict";function e(t,e){this.init(t,e)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.init=function(e,i){t.prototype.init.call(this,e,i),this.el.classList.add("rs-bb3d-mainbutton")},e.prototype.addClass=function(t){this.el.classList.add(t)},e.prototype.removeClass=function(t){this.el.classList.remove(t)},e}),i("rs/bb3d/ui/GameScreenButtonBar",["rs/bb3d/ui/GameButton"],function(t){"use strict";function e(t){this.gs=t,this.am=this.gs.bb3d.assetManager,this.init()}return e.prototype.init=function(){var e=this.el=document.createElement("div");e.className="rs-bb3d-gamebuttonbar";this.am;this.downloadBtn=new t("icon-download",this.downloadImage.bind(this)),this.downloadBtn.addClass("rs-bb3d-mainbutton-extra"),e.appendChild(this.downloadBtn.el),this.newSceneBtn=new t("icon-new-scene",this.newScene.bind(this)),this.newSceneBtn.addClass("rs-bb3d-mainbutton-extra"),e.appendChild(this.newSceneBtn.el),this.infoBtn=new t("icon-info",this.showHelp.bind(this)),e.appendChild(this.infoBtn.el),this.homeBtn=new t("icon-home",this.showHome.bind(this)),e.appendChild(this.homeBtn.el),this.soundBtn=new t("icon-sound-on",this.toggleSound.bind(this)),this.soundBtn.isOn=!0,e.appendChild(this.soundBtn.el)},e.prototype.show=function(){anime({targets:this.el,bottom:15,easing:"easeOutQuint",duration:800})},e.prototype.hide=function(){anime({targets:this.el,bottom:-50,easing:"easeOutQuint",duration:800})},e.prototype.downloadImage=function(){this.am.btnClick.play();var t=this.gs.game3d.el.toDataURL("image/png").replace("image/png","image/octect-stream"),e=document.createElement("a");e.href=t,e.download="block-builder.png",e.click()},e.prototype.newScene=function(){this.am.btnClick.play(),confirm("Delete everything and start over?")&&this.gs.game3d.container.blockModel.newScene();var t=this.gs.bb3d.pref.data.swatches;t.splice(0),t.push("#ffe048"),this.gs.bb3d.pref.save(),this.gs.header.cp.reset()},e.prototype.showHome=function(t){this.gs.bb3d.assetManager.btnClick.play(),this.gs.bb3d.setHomeScreen()},e.prototype.showHelp=function(t){this.gs.bb3d.assetManager.btnClick.play(),this.gs.hpanel.show()},e.prototype.toggleSound=function(){var t=this.gs.bb3d.assetManager,e=this.soundBtn;e.isOn=!this.soundBtn.isOn,e.isOn?(e.removeClass("icon-sound-off"),e.addClass("icon-sound-on"),t.btnClick.play()):(e.removeClass("icon-sound-on"),e.addClass("icon-sound-off")),t.toggleSound()},e.prototype.getClientSize=function(){return[this.el.clientWidth,this.el.clientHeight]},e}),i("rs/bb3d/ui/GameScreenWonBar",["rs/bb3d/ui/GameButton"],function(t){"use strict";function e(t){this.gs=t,this.init()}return e.prototype.init=function(){var e=this.el=document.createElement("div");e.className="rs-bb3d-gamewonbar",e.style.bottom="-85px",this.status=document.createElement("h1"),this.status.className="trophy-level-title",this.status.innerHTML="DRAW",this.nextBtn=new t("icon-nextlevel",this.doNext.bind(this)),this.nextBtn.addClass("rs-bb3d-mainbutton-extra"),e.appendChild(this.nextBtn.el)},e.prototype.doNext=function(){this.gs.bb3d.assetManager.btnClick.play(),this.gs.nextLevel()},e.prototype.show=function(t){anime({targets:this.el,bottom:12,easing:"easeOutQuint",duration:800}),this.setStatus(t),document.body.appendChild(this.status)},e.prototype.setStatus=function(t){this.status.innerHTML=t},e.prototype.hide=function(t){anime({targets:this.el,bottom:-85,easing:"easeOutQuint",duration:800}),document.body.contains(this.status)&&document.body.removeChild(this.status)},e}),i("rs/bb3d/ui/GameScreenLoseBar",["rs/bb3d/ui/GameButton"],function(t){"use strict";function e(t){this.gs=t,this.init()}return e.prototype.init=function(){var e=this.el=document.createElement("div");e.className="rs-bb3d-gamewonbar",e.style.bottom="-85px",this.replayBtn=new t("icon-undo",this.doReplay.bind(this)),this.replayBtn.addClass("rs-bb3d-mainbutton-extra"),e.appendChild(this.replayBtn.el),this.status=document.createElement("h1"),this.status.className="trophy-level-title",this.status.innerHTML="DRAW"},e.prototype.doReplay=function(){this.gs.bb3d.assetManager.btnClick.play(),this.gs.replayLevel()},e.prototype.show=function(t){anime({targets:this.el,bottom:12,easing:"easeOutQuint",duration:800}),this.setStatus(t),document.body.appendChild(this.status)},e.prototype.hide=function(){anime({targets:this.el,bottom:-85,easing:"easeOutQuint",duration:800}),document.body.contains(this.status)&&document.body.removeChild(this.status)},e.prototype.setStatus=function(t){this.status.innerHTML=t},e}),i("rs/bb3d/ui/ColorPickerButton",["rs/game/IconButton"],function(t){"use strict";function e(t){this.gs=t,this.init()}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.init=function(){t.prototype.init.call(this,"icon-colorpicker",this.activePanel.bind(this)),this.el.classList.add("rs-bb3d-mainbutton"),this.el.style.backgroundColor="#ffe048",this.el.style.width=this.el.style.height="36px"},e.prototype.activePanel=function(){var t=this.gs.colorPanel;this.gs.bb3d.assetManager.btnClick.play(),t.show()},e.prototype.setColor=function(t){this.currentPattern&&this.el.classList.remove(this.currentPattern),this.el.style.backgroundColor=t},e.prototype.setPattern=function(t){this.currentPattern&&this.el.classList.remove(this.currentPattern),this.el.classList.add(t),this.currentPattern=t},e.prototype.addClass=function(t){this.el.classList.add(t)},e.prototype.removeClass=function(t){this.el.classList.remove(t)},e.prototype.reset=function(){this.el.style.backgroundColor="#ffe048"},e}),i("rs/bb3d/ui/HeaderTimeButton",[],function(){"use strict";function t(t){this.gh=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-bb3d-timebtn",this.isPlaying=!1,this.currentTime=0;var e=this.gh,i=this;t.addEventListener("click",function(t){e.gs.bb3d.assetManager.btnClick.play(),i.toggleTime()});var n=this.ticon=document.createElement("span");t.appendChild(n),n.className="icon-timer";var s=this.tval=document.createElement("span");s.className="timebtn-value",t.appendChild(s),s.innerHTML="00:00:00";var o=this.tpause=document.createElement("span");o.className="icon-pausetime",t.appendChild(o)},t.prototype.resume=function(){clearInterval(this.timeId),this.timeId=setInterval(this.timeTick.bind(this),1e3),this.isPlaying=!0,this.tpause.className="icon-pausetime"},t.prototype.pause=function(){clearInterval(this.timeId),this.isPlaying=!1,this.tpause.className="icon-playtime"},t.prototype.reset=function(){this.currentTime=0,this.tval.innerHTML="00:00:00"},t.prototype.timeTick=function(){function t(t){return t<10?"0"+t:t}this.currentTime+=1;var e=this.currentTime,i=Math.floor(e/3600),n=Math.floor((e-3600*i)/60),s=(e-3600*i)%60
;this.tval.innerHTML=t(i)+":"+t(n)+":"+t(s)},t.prototype.toggleTime=function(){this.gh.gs.game3d.isRunningState()&&(this.isPlaying=!this.isPlaying,this.isPlaying?this.resume():this.pause())},t}),i("rs/bb3d/ui/HeaderLevelButton",[],function(){"use strict";function t(t){this.gh=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-bb3d-levelbtn";var e=this.gh;this.el.addEventListener("click",function(t){e.gs.game3d.shuffle()}),this.label=document.createElement("span"),this.label.className="levelbtn-label",t.appendChild(this.label),this.btn=document.createElement("span"),this.btn.className="levelbtn-shuffle icon-shuffle",t.appendChild(this.btn),this.setLevel(1)},t.prototype.setLevel=function(t){function e(){return Math.floor(150*Math.random())}this.label.innerHTML="Level "+t,this.el.style.backgroundColor="rgba("+e()+", "+e()+", "+e()+", 1)"},t}),i("rs/bb3d/ui/HeaderMoveButton",[],function(){"use strict";function t(t){this.gh=t,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-bb3d-movebtn";var e=this.gh;t.addEventListener("click",function(t){e.gs.bb3d.assetManager.btnClick.play(),e.gs.boardPanel.show()});var i=this.micon=document.createElement("span");t.appendChild(i),i.className="icon-quill";var n=this.mval=document.createElement("span");n.className="movebtn-value",t.appendChild(n),n.innerHTML="0000"},t.prototype.update=function(t,e){this.mval.innerHTML=t+"&times;"+e},t.prototype.reset=function(){},t}),i("rs/bb3d/ui/DurationBar",[],function(){"use strict";function t(t){this.gh=t,this.init()}return t.prototype.init=function(){var t=document.createElement("div");this.el=t,t.className="rs-bb3d-dbar",this.bar=document.createElement("div"),this.bar.className="progress-bar",t.appendChild(this.bar),this.label=document.createElement("div"),this.label.className="duration-label",this.label.innerHTML=100,t.appendChild(this.label)},t.prototype.setValue=function(t){anime({targets:this.bar,width:100*t+"%",easing:"linear",duration:1e3})},t.prototype.setDuration=function(t){this.duration=this.currentValue=this.label.innerHTML=t},t.prototype.start=function(){var t=this;clearInterval(this.counterId),this.counterId=setInterval(function(){t.currentValue-=1,t.currentValue<=0&&(t.gh.gs.game3d.setLoseState(),t.stop());var e=t.currentValue/t.duration;t.bar.style.width=100*e+"%",t.label.innerHTML=t.currentValue},1e3)},t.prototype.stop=function(){clearInterval(this.counterId)},t.prototype.reset=function(){this.bar.style.width="100%"},t}),i("rs/bb3d/ui/GameScreenHeader",["rs/bb3d/ui/GameButton","rs/bb3d/ui/ColorPickerButton","rs/bb3d/ui/HeaderTimeButton","rs/bb3d/ui/HeaderLevelButton","rs/bb3d/ui/HeaderMoveButton","rs/bb3d/ui/DurationBar"],function(t,e,i,n,s,o){"use strict";function r(t){this.gs=t,this.init()}return r.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-bb3d-gameheader",this.createToolIcons(),this.cp=new e(this.gs),t.append(this.cp.el)},r.prototype.createToolIcons=function(){function e(t){i&&i.classList.remove("rs-button-active"),i=t,i.classList.add("rs-button-active"),n.bb3d.assetManager.btnClick.play()}var i,n=this.gs,s=this.el,o=n.imodal;this.buildBtn=new t("icon-build",function(t){n.game3d.actionState.setBuildState(),e(this.el),o.show("BUILD")}),this.buildBtn.el.classList.add("rs-bb3d-mainbutton-tool"),s.appendChild(this.buildBtn.el),e(this.buildBtn.el),this.desBtn=new t("icon-destroy",function(t){n.game3d.actionState.setDestroyState(),e(this.el),o.show("DESTROY")}),this.desBtn.el.classList.add("rs-bb3d-mainbutton-tool"),s.appendChild(this.desBtn.el),this.scaleUpBtn=new t("icon-scale-up",function(t){n.game3d.actionState.setScaleUpState(),e(this.el),o.show("SCALE UP")}),this.scaleUpBtn.el.classList.add("rs-bb3d-mainbutton-tool"),s.appendChild(this.scaleUpBtn.el),this.scaleDownBtn=new t("icon-scale-down",function(t){n.game3d.actionState.setScaleDownState(),e(this.el),o.show("SCALE DOWN")}),this.scaleDownBtn.el.classList.add("rs-bb3d-mainbutton-tool"),s.appendChild(this.scaleDownBtn.el),this.paintBtn=new t("icon-paint",function(t){n.game3d.actionState.setPaintState(),e(this.el),o.show("PAINT")}),this.paintBtn.el.classList.add("rs-bb3d-mainbutton-tool"),s.appendChild(this.paintBtn.el),this.blockTypeBtn=new t("icon-block-type",function(t){var e=n.game3d.actionState;this.type=Math.abs(1-this.type),e.setBlockType(this.type),0==this.type?(this.el.className=this.el.className.replace("plane","block"),o.show("BLOCK TYPE")):(this.el.className=this.el.className.replace("block","plane"),o.show("PLANE TYPE")),n.bb3d.assetManager.btnClick.play()}),this.blockTypeBtn.type=0,this.blockTypeBtn.el.classList.add("rs-bb3d-mainbutton-tool"),s.appendChild(this.blockTypeBtn.el)},r.prototype.getClientSize=function(){return[this.el.clientWidth,this.el.clientHeight]},r.prototype.show=function(){anime({targets:this.el,top:4,easing:"easeOutQuint",duration:800})},r.prototype.hide=function(){anime({targets:this.el,top:-60,easing:"easeOutQuint",duration:800})},r}),i("rs/bb3d/ui/GameScreenSubHeader",["rs/bb3d/ui/GameButton","rs/bb3d/ui/HeaderTimeButton","rs/bb3d/ui/HeaderLevelButton","rs/bb3d/ui/HeaderMoveButton","rs/bb3d/ui/DurationBar"],function(t,e,i,n,s){"use strict";function o(t){this.gs=t,this.init()}return o.prototype.init=function(){(this.el=document.createElement("div")).className="rs-bb3d-gameheader";this.gs},o.prototype.getClientSize=function(){return[this.el.clientWidth,this.el.clientHeight]},o.prototype.show=function(){anime({targets:this.el,top:4,easing:"easeOutQuint",duration:800})},o.prototype.hide=function(){anime({targets:this.el,top:-60,easing:"easeOutQuint",duration:800})},o}),i("rs/utils/ObjectUtil",[],function(){"use strict";var t={merge:function(t,e,i){for(var n in t)"[object Object]"===Object.prototype.toString.call(t[n])?(void 0===e[n]&&(e[n]={}),this.merge(t[n],e[n])):e[n]=t[n];return e},clone:function(e,i){var n={};return t.merge(e,n,i),n}};return t}),i("rs/game3d/Firework3DState",[],function(){"use strict";return{EXPLODED:0,FALLING:1,EXPIRED:2}}),i("rs/game3d/Firework3D",["rs/utils/ObjectUtil","rs/game3d/Firework3DState"],function(t,e){"use strict";function i(i){this.config={launchHeight:300,sphereRadius:200,color:16763904,size:72,numParticles:24},i=i||{},t.merge(i,this.config),this.state=e.EXPLODED,this.init()}var n=[16777215,16776960,14352128,16711844,15990528];return i.prototype=Object.create(THREE.Points.prototype),i.prototype.constructor=i,i.prototype.init=function(){THREE.Points.prototype.constructor.call(this);var t=this.config;this.geometry=new THREE.Geometry;for(var e=this.geometry.vertices,i=0;i<t.numParticles;i++){var s=new THREE.Vector3;s.tX=2*Math.random()*t.sphereRadius-t.sphereRadius+50,s.tY=2*Math.random()*t.sphereRadius-t.sphereRadius+50,s.tZ=2*Math.random()*t.sphereRadius-t.sphereRadius+50,e.push(s)}this.geometry.verticesNeedUpdate=!0;var o=n[Math.floor(Math.random()*n.length)];this.material=new THREE.PointsMaterial({size:t.size,color:o,opacity:1,transparent:!0,blending:THREE.AdditiveBlending,depthTest:!1,map:t.map}),this.material.needsUpdate=!0},i.prototype.setRegion=function(t,e){this.regionWidth=t,this.regionHeight=e},i.prototype.update=function(t){var i=this.geometry.vertices;if(this.state==e.EXPLODED){for(var n=0;n<i.length;n++){var s=i[n];s.x+=.1*(s.tX-s.x),s.y+=.1*(s.tY-s.y),s.z+=.1*(s.tZ-s.z)}Math.abs(s.tX-s.x)<5&&(this.state=e.FALLING)}else{for(var o=-80*t,n=0;n<i.length;n++){var s=i[n];s.vy+=o,s.y+=s.vy}this.material.opacity+=.025*(0-this.material.opacity),this.material.opacity<=.05&&this.reset()}this.geometry.verticesNeedUpdate=!0},i.prototype.reset=function(){if(this.regionWidth){this.position.x=Math.random()*this.regionWidth-.5*this.regionWidth;var t=this.regionHeight-this.config.launchHeight;this.position.y=Math.random()*t-.5*t}this.state=e.EXPLODED,this.material.opacity=1,this.material.color.set(n[Math.floor(Math.random()*n.length)]),this.rotation.z=0;for(var i=this.geometry.vertices,s=this.config,o=0;o<i.length;o++){var r=i[o];r.x=r.y=r.z=r.vy=0,r.tX=2*Math.random()*s.sphereRadius-s.sphereRadius+50,r.tY=2*Math.random()*s.sphereRadius-s.sphereRadius+50,r.tZ=2*Math.random()*s.sphereRadius-s.sphereRadius+50}this.geometry.verticesNeedUpdate=!0,this.material.needsUpdate=!0,s.callback&&s.callback.call(this)},i}),i("rs/game3d/Firework3DSet",["rs/utils/ObjectUtil","rs/game3d/Firework3D","rs/game3d/Firework3DState"],function(t,e,i){"use strict";function n(e,i){this.g3d=e,this.config={numFireworks:3,interval:500},i=i||{},t.merge(i,this.config),this.init()}return n.prototype=Object.create(THREE.Group.prototype),n.prototype.constructor=n,n.prototype.init=function(){THREE.Group.prototype.constructor.call(this);for(var t=this.config,i=this.g3d.gs.bb3d.assetManager.fwTexture,n=0;n<t.numFireworks;n++){var s=new e({map:i,callback:t.callback});this.add(s)}},n.prototype.update=function(t){for(var e=0;e<this.children.length;e++){this.children[e].update(t)}},n.prototype.changeRegion=function(t,e){this.children.forEach(function(i){i.setRegion(t,e)})},n.prototype.reset=function(){this.children.forEach(function(t){t.reset()})},n}),i("rs/bb3d/BlockModelAction",[],function(){"use strict";return{BUILD:0,DESTROY:1,PUSH:2,PULL:3,ROTATE:4,SCALE_UP:5,SCALE_DOWN:6,PAINT:7}}),i("rs/bb3d/ActionState",["rs/bb3d/BlockModelAction"],function(t){"use strict";function e(){this.init()}return e.prototype.init=function(){this.type=t.BUILD,this.blockType=0,this.blockSize=1,this.texture=16769096,this.obj=null,this.objExtra=null},e.prototype.update=function(t){for(var e in t)this[e]=t[e]},e.prototype.setDestroyState=function(){this.type=t.DESTROY},e.prototype.setBuildState=function(){this.type=t.BUILD},e.prototype.setScaleUpState=function(){this.type=t.SCALE_UP},e.prototype.setScaleDownState=function(){this.type=t.SCALE_DOWN},e.prototype.setPaintState=function(){this.type=t.PAINT},e.prototype.setBlockType=function(t){this.blockType=t},e.prototype.setTexture=function(t,e){this.texture=t,this.texId=e},e}),i("rs/bb3d/entity/Floor",[],function(){"use strict";function t(t){this.g3d=t,this.dopt=t.dopt,this.init()}return t.prototype=Object.create(THREE.Group.prototype),t.prototype.constructor=t,t.prototype.init=function(){THREE.Group.prototype.constructor.call(this);var t=this.blockSize=128,e=this.gridSize=21*t,i=new THREE.Mesh(new THREE.PlaneBufferGeometry(e,e),new THREE.MeshBasicMaterial({color:5592405,depthWrite:!1}));i.rotation.x=-Math.PI/2,i.position.y=.5*-t,i.isFloor=!0,this.add(i);var n=e/t,s=new THREE.GridHelper(e,n,0,0);s.material.opacity=.8,s.position.y=.5*-t,s.material.transparent=!1,s.isFloor=!0,this.add(s)},t.prototype.getMatrixPosition=function(t){var e=(this.blockSize,t.x/this.gridSize+.5),i=.5+t.z/this.gridSize,n=Math.floor(21*e);return[Math.floor(21*i),n]},t}),i("rs/bb3d/entity/BlockUnit",[],function(){function t(t){this.pb=t,this.isUnit=!0,this.iscale=1,this.yscale=i/e,this.bid=Math.floor(1e4*Math.random()),this.init()}var e=128,i=8;return t.prototype=Object.create(THREE.Mesh.prototype),t.prototype.constructor=t,t.prototype.init=function(){THREE.Mesh.prototype.constructor.call(this);var t=new THREE.BoxBufferGeometry(e,e,e),i=new THREE.MeshBasicMaterial({color:16711680}),n=new THREE.LineSegments(new THREE.EdgesGeometry(t),new THREE.LineBasicMaterial({color:0}));n.renderOrder=1,this.wireframe=n,this.geometry=t,this.material=i},t.prototype.makeFlat=function(t){1==t?this.scale.set(1,this.yscale,1):this.scale.set(1,1,1)},t.prototype.updateTexture=function(t,e){"number"==typeof t?(this.material.map=null,this.material.color.setHex(t),this.color=t,this.texId=null,this.add(this.wireframe)):(this.material.map=t,this.material.color.setHex(16777215),this.remove(this.wireframe),this.color=null,this.texId=e),this.material.needsUpdate=!0},t.prototype.reset=function(){this.scale.set(1,1,1),this.iscale=1,this.rotation.set(0,0,0),this.texId=null},t}),i("rs/bb3d/entity/BlockUnitPool",["rs/bb3d/entity/BlockUnit"],function(t){"use strict";function e(t){this.pb=t,this.init()}return e.prototype.init=function(){this.pool=[];for(var e=this.pb,i=0;i<10;i++){var n=new t(e);this.pool.push(n)}},e.prototype.obtain=function(e){if(this.pool.length>0){var i=this.pool.pop();return i}var i=new t(this.pb);return i},e.prototype.free=function(t){this.pool.push(t),t.reset()},e}),i("rs/bb3d/BlockModel",["rs/bb3d/BlockModelAction","rs/bb3d/entity/BlockUnitPool"],function(t,e){"use strict";function i(t){this.g3d=t,this.am=t.bb3d.assetManager,this.pref=t.bb3d.pref,this.dopt=t.dopt,this.init()}return i.prototype=Object.create(THREE.Group.prototype),i.prototype.constructor=i,i.prototype.init=function(){THREE.Group.prototype.constructor.call(this),this.bpool=new e(this),this.blockData=this.pref.data.blockData,this.construct(this.blockData),this.offset=-1280},i.prototype.construct=function(t){for(var e in t){var i=t[e],n=this.bpool.obtain();if(n.bid=parseInt(e),n.position.set(i.x,i.y,i.z),n.scale.set(i.sx,i.sy,i.sz),n.iscale=i.iscale,null!==i.color)n.updateTexture(i.color,null);else for(var s=this.am.textures,o=0;o<s.length;o++)if(s[o].key==i.texId){n.updateTexture(s[o].tex,i.texId);break}this.add(n)}},i.prototype.newScene=function(){for(var t in this.blockData)delete this.blockData[t];for(;this.children.length>0;)this.bpool.free(this.children[0]),this.remove(this.children[0]);this.pref.save()},i.prototype.processAction=function(e){switch(e.type){case t.BUILD:Array.isArray(e.obj)?this.buildBlockFromGrid(e):this.buildBlockFromBlock(e);break;case t.DESTROY:if(Array.isArray(e.obj))return void this.am.error.play();this.destroyBlock(e.obj);break;case t.SCALE_UP:if(Array.isArray(e.obj))return void this.am.error.play();this.scaleUp(e.obj);break;case t.SCALE_DOWN:if(Array.isArray(e.obj))return void this.am.error.play();this.scaleDown(e.obj);break;case t.PAINT:if(Array.isArray(e.obj))return void this.am.error.play();this.paint(e)}},i.prototype.buildBlockFromGrid=function(t){var e=128*t.obj[1]+this.offset,i=128*t.obj[0]+this.offset,n=0;1==t.blockType&&(n=-60),this.build(t,e,n,i)},i.prototype.buildBlockFromBlock=function(t){if(1==t.blockType||t.obj.scale.y<1)return void this.am.error.play();var e=t.objExtra.normal,i=t.obj,n=.5*(128+128*i.iscale),s=i.position.y+e.y*n;this.build(t,i.position.x+e.x*n,s,i.position.z+e.z*n)},i.prototype.paint=function(t){var e=t.obj;e.updateTexture(t.texture,t.texId),this.updateTexture(e),this.am.popSound.play()},i.prototype.build=function(t,e,i,n){var s=this.bpool.obtain(t.blockType);s.position.set(e,i,n),this.add(s),this.updatePosition(s,e,i,n),s.updateTexture(t.texture,t.texId),this.updateTexture(s);0==t.blockType?(s.scale.set(.25,.25,.25),anime.remove(s.scale),anime({targets:s.scale,x:1,y:1,z:1,duration:1e3}),this.updateScale(s,1,1,1,s.iscale)):(s.scale.set(.25,s.yscale,.25),anime.remove(s.scale),anime({targets:s.scale,x:1,z:1,duration:1e3}),this.updateScale(s,1,s.yscale,1,s.iscale)),this.am.popSound.play()},i.prototype.scaleUp=function(t){if(t.scale.y<1)return void this.am.error.play();t.iscale+=.5;var e=t.iscale,i=e;anime.remove(t.scale),anime({targets:t.scale,x:e,y:i,z:e,easing:"easeOutQuint"}),this.updateScale(t,e,i,e,t.iscale),this.am.scaleUp.play()},i.prototype.scaleDown=function(t){if(1==t.iscale||t.scale.y<1)return void this.am.error.play();t.iscale-=.5;var e=t.iscale,i=e;t.scale.y<1&&(i=t.yscale),anime.remove(t.scale),anime({targets:t.scale,x:e,y:i,z:e,easing:"easeOutQuint"}),this.updateScale(t,e,i,e,t.iscale),this.am.scaleDown.play()},i.prototype.destroyBlock=function(t){var e=this;anime.remove(t.scale),anime({targets:t.scale,x:.01,y:.01,z:.01,duration:800,easing:"easeOutQuint",complete:function(){e.remove(t),e.bpool.free(t)}}),this.am.breakSound.play(),this.destroyData(t)},i.prototype.updatePosition=function(t,e,i,n){var s=this.blockData;void 0==s[t.bid]&&(s[t.bid]={}),s[t.bid].x=e,s[t.bid].y=i,s[t.bid].z=n,this.pref.save()},i.prototype.updateScale=function(t,e,i,n,s){var o=this.blockData;void 0==o[t.bid]&&(o[t.bid]={}),o[t.bid].sx=e,o[t.bid].sy=i,o[t.bid].sz=n,o[t.bid].iscale=s,this.pref.save()},i.prototype.updateTexture=function(t){var e=this.blockData;void 0==e[t.bid]&&(e[t.bid]={}),e[t.bid].texId=t.texId,e[t.bid].color=t.color,this.pref.save()},i.prototype.destroyData=function(t){delete this.blockData[t.bid],this.pref.save()},i}),i("rs/utils/ImageUtil",["rs/utils/ObjectUtil"],function(t){"use strict";return{createReflection:function(t,e){if(void 0===t)throw"Invalid input image";void 0===e&&(e=[0,.5,.4,.25,1,0]);var i=t.width,n=t.height,s=document.createElement("canvas");s.width=i,s.height=n;for(var o=s.getContext("2d"),r=o.createLinearGradient(0,0,0,n),a=.5*e.length,c=0;c<a;c++)r.addColorStop(e[2*c],"rgba(0, 0, 0, "+e[2*c+1]+")");o.fillStyle=r,o.fillRect(0,0,i,n),o.globalCompositeOperation="source-in",o.translate(0,t.height),o.scale(1,-1),o.drawImage(t,0,0);var l=document.createElement("img");return l.src=s.toDataURL(),l}}}),i("rs/bb3d/Game3dContainer",["rs/bb3d/BlockModel","rs/utils/ImageUtil"],function(t,e){"use strict";function i(t){this.g3d=t,this.currentRotZ=0,this.init()}i.prototype=Object.create(THREE.Group.prototype),i.prototype.constructor=i;return i.prototype.init=function(){THREE.Group.prototype.constructor.call(this),this.blockModel=new t(this.g3d),this.add(this.blockModel)},i.prototype.testBlock3D=function(){var t=(new THREE.TextureLoader).load("https://cdn.jsdelivr.net/gh/classroom-management/tyt@main/atlas.png");t.minFilter=THREE.LinearMipmapLinearFilter;var e=new THREE.BoxGeometry(128,128,128),i=new THREE.MeshBasicMaterial({map:t}),n=new THREE.Mesh(e,i),s=new THREE.EdgesGeometry(n.geometry),o=new THREE.LineBasicMaterial({color:0});new THREE.LineSegments(s,o).renderOrder=1;for(var r=0,a=0,c=e.faceVertexUvs[0],r=0;r<12;r++)for(var a=0;a<3;a++)c[r][a].x=.499*c[r][a].x,c[r][a].y=.499*c[r][a].y;e.uvsNeedUpdate=!0;var l=n.clone();l.position.x=128,this.add(n),this.add(l)},i.prototype.show=function(){this.visible=!1;this.position.z;this.rotation.x=-Math.PI/3,this.position.y=0;var t=this;this.scale.set(.01,.01,.01),anime.remove(this.scale),anime({targets:this.scale,x:1,y:1,z:1,easing:"easeOutQuad",duration:1200}),anime.remove(this.rotation),anime({targets:this.rotation,x:0,easing:"easeOutCubic",duration:1500,complete:function(){setTimeout(function(){},600)}}),setTimeout(function(){t.visible=!0},140)},i}),i("rs/bb3d/Game3d",["rs/three/BaseApp","rs/utils/ObjectUtil","rs/utils/BrowserUtil","rs/game3d/Firework3DSet","rs/bb3d/ActionState","rs/bb3d/BlockModelAction","rs/bb3d/entity/Floor","rs/bb3d/Game3dContainer"],function(t,e,i,n,s,o,r,a){"use strict";function c(e){this.gs=e,this.config=e.config,this.bb3d=e.bb3d,this.dopt=this.bb3d.defaultOptions,this.am=this.bb3d.assetManager;t.prototype.constructor.call(this,500,300),this.setCameraMatchProjection(),this.defaultCursor="auto",this.buildScene(),this.enableOrbitControl()}c.prototype=Object.create(t.prototype),c.prototype.constructor=c;var l={RUNNING:0,WON:1,LOSE:2};return c.prototype.enableOrbitControl=function(){this.controls=new OrbitControls(this.camera,this.el),this.controls.enableDamping=!0},c.prototype.buildScene=function(){this.container=new a(this),this.clock=new THREE.Clock;var t=this.scene;t.add(this.container);var e=this.am;this.f3ds=new n(this,{numParticles:3,callback:function(){e.firework.play()}}),t.add(this.f3ds),this.floor=new r(this),t.add(this.floor),this.actionState=new s,window.as=this.actionState,this.setRunningState(),this._setUpRaycaster(),this.resizeHandler()},c.prototype._setUpRaycaster=function(){function t(t){var i,a;t.touches?(i=t.touches[0].clientX,a=t.touches[0].clientY):t.changedTouches?(i=t.changedTouches[0].clientX,a=t.changedTouches[0].clientY):(i=t.offsetX,a=t.offsetY);var d={x:i/l.width*2-1,y:-a/l.height*2+1};o.setFromCamera(d,s);for(var p=o.intersectObjects(r.children,!0),m=0;m<p.length;m++){var b=p[m].object,f=p[m].point;"pointerdown"==t.type?(e=i,n=a):"pointerup"==t.type&&i==e&&a==n&&(b.isFloor?h.update({obj:u.getMatrixPosition(f)}):b.isUnit&&h.update({obj:b,objExtra:p[m].face}),c.processAction(h));break}}var e,n,s=this.camera,o=this.raycaster,r=(this.container,this.scene),a=this.el,c=this.container.blockModel,l=this,h=(this.am,this.actionState),u=this.floor;i.getMouseTouchEvents();a.addEventListener("pointerdown",t),a.addEventListener("pointerup",t)},c.prototype.loadLevel=function(t,e){this.setRunningState();var i=this;this.container.visible=!1,i.container.show(),e.call(i)},c.prototype._renderRequest=function(){t.prototype._renderRequest.call(this);var e=this.clock.getDelta();this.controls&&this.controls.update(),this.state==l.WON&&this.f3ds.update(e);var i=this.container;i.rotation.z+=.075*(i.currentRotZ-i.rotation.z)},c.prototype.setRunningState=function(){this.state=l.RUNNING,this.f3ds.visible=!1,this.gs.header.show()},c.prototype.isRunningState=function(){return this.state==l.RUNNING},c.prototype.resize=function(t,e){this.width=t,this.height=e,this.camera.aspect=t/e,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,e),this.resizeHandler(),this.f3ds.changeRegion(t,e),this.camera.position.y=300,this.camera.lookAt(new THREE.Vector3)},c.prototype.resizeHandler=function(e){t.prototype.resizeHandler.call(this),this.setCameraMatchProjection()},c.prototype.show=function(){this.el.style.display="block"},c.prototype.hide=function(){this.el.style.display="none"},c.prototype.shuffle=function(){this.isRunningState()&&(this.container.isShuffling||(this.container.shuffle(),this.gs.reset()))},c.prototype.destroy=function(){},c}),i("rs/bb3d/screen/GameScreen",["rs/game/ImagePanel","rs/bb3d/ui/InfoModal","rs/bb3d/ui/ColorPatternPanel","rs/bb3d/ui/BoardPanel","rs/bb3d/ui/HelpPanel","rs/bb3d/ui/GameScreenButtonBar","rs/bb3d/ui/GameScreenWonBar","rs/bb3d/ui/GameScreenLoseBar","rs/bb3d/ui/GameScreenHeader","rs/bb3d/ui/GameScreenSubHeader","rs/bb3d/Game3d"],function(t,e,i,n,s,o,r,a,c,l,h){"use strict";function u(t,e){this.bb3d=t,this.config=t.config,this.init()}return u.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-gscreen",t.style.width=t.style.height="100%",t.style.display="none",this.initPanel(),this.header=new c(this),t.appendChild(this.header.el),this.bbar=new o(this),t.appendChild(this.bbar.el),this.wbar=new r(this),t.appendChild(this.wbar.el),this.lbar=new a(this),t.appendChild(this.lbar.el),this.game3d=new h(this),t.appendChild(this.game3d.el),this.currentLevel=0},u.prototype.initPanel=function(){this.boardPanel=new n(this),this.imagePanel=new t,this.colorPanel=new i(this),this.bb3d.homeScreen?this.hpanel=this.bb3d.homeScreen.hpanel:this.hpanel=new s,this.imodal=new e(this)},u.prototype.loadLevel=function(t){function e(){i.bb3d.hidePreloader(),i.reset()}var i=this;this.colorPanel.hide(),this.wbar.hide(),this.lbar.hide(),this.showButtonBar(),this.bb3d.showPreloader(),this.game3d.loadLevel(t,e),this.currentLevel=t},u.prototype.loadCategory=function(t){this.currentCategory=t,this.loadLevel(0)},u.prototype.replayLevel=function(){this.loadLevel(this.currentLevel)},u.prototype.nextLevel=function(){var t=this.currentLevel+1;t==this.levels[this.currentCategory].content.length&&(t=0),this.loadLevel(t)},u.prototype.unlockNextLevel=function(){var t=this.currentLevel+1,e=this.levels[this.currentCategory];t<e.content.length&&this.bb3d.pref.saveUnlock(e.name,t)},u.prototype.getCurrentImagePath=function(){var t=this.levels[this.currentCategory],e=t.content[this.currentLevel].path;return void 0==e&&(e=this.game3d.container.puzzleBoard.dataUrl),e},u.prototype.reset=function(){},u.prototype.show=function(t){this.currentCategory=0,this.bb3d.root.appendChild(this.el),this.transitionIn();var e=this.bb3d.getAppDimension();this.game3d.resize(e[0],e[1]),this.game3d.startRendering(),void 0==t&&(t=0),this.loadLevel(t)},u.prototype.hide=function(){this.bb3d.root.removeChild(this.el),this.game3d.stopRendering()},u.prototype.showWonBar=function(){this.bbar.hide();var t=this.wbar;setTimeout(function(){t.show("LEVEL PASSED")},400)},u.prototype.showLoseBar=function(){this.bbar.hide();var t=this.lbar;setTimeout(function(){t.show("Time out")},400)},u.prototype.showButtonBar=function(){this.wbar.hide();var t=this.bbar;setTimeout(function(){t.show()},400)},u.prototype.transitionIn=function(){this.el.style.display="block"},u.prototype.transitionOut=function(){},u.prototype.resize=function(t,e){this.game3d.resize(t,e)},u.prototype.dispose=function(){},u}),i("rs/bb3d/screen/LevelScreen",[],function(){"use strict";function t(t,e){this.bb3d=t,this.config=t.config,this.init()}return t.prototype.init=function(){var t=this.el=document.createElement("div");t.className="rs-lscreen",t.style.width=t.style.height="100%",t.style.display="none",this.bb3d.root.appendChild(t)},t.prototype.show=function(){},t.prototype.hide=function(){},t.prototype.resize=function(){},t}),i("rs/ui/RingPreloader",["rs/utils/ObjectUtil"],function(t){"use strict";function e(e){this.dopt={size:40,borderWidth:6,borderColor:"#AAA"},t.merge(e,this.dopt),this.build()}return e.prototype.build=function(){var t=this.dopt,e=this.el=document.createElement("div");e.className="rs-ringpreloader",e.innerHTML="<div class='lds-ring'><div></div><div></div><div></div><div></div></div>",e.style.marginLeft=e.style.marginTop=.5*-t.size+"px";for(var i=e.firstChild.children,n=0;n<i.length;n++){var s=i[n].style;s.width=s.height=t.size+"px",s.borderWidth=t.borderWidth+"px",s.borderTopColor=t.borderColor}},e.prototype.show=function(){this.el.style.display="block"},e.prototype.hide=function(){this.el.style.display="none"},e}),i("rs/utils/MouseUtil",["rs/utils/BrowserUtil"],function(t){"use strict";function e(t){t.preventDefault(),t.currentTarget.mouseWheelCallback.call(t.currentTarget.mousewheelContext,Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)))}return{touchClick:function(e,i){t.isMobile()?e.addEventListener("touchstart",i):e.addEventListener("click",i)},removeTouchClick:function(e,i){t.isMobile()?e.removeEventListener("touchstart",i):e.removeEventListener("click",i)},startMouseWheel:function(t,i,n){t.mouseWheelCallback=i,t.mousewheelContext=n,t.addEventListener("DOMMouseScroll",e,!1),t.addEventListener("mousewheel",e,!1)},stopMouseWheel:function(t){t.removeEventListener("DOMMouseScroll",e),t.removeEventListener("mousewheel",e)},swipeStart:function(e,i,n,s,o){function r(t){p=t.clientX,m=t.clientY,b=(new Date).getTime(),e.addEventListener("mousemove",c),window.addEventListener("mouseup",l)}function a(t){e.removeEventListener("mousemove",c),window.removeEventListener("mouseup",l),e.removeEventListener("mouseout",a)}function c(e){var i=e.clientX-p,r=e.clientY-m;t.swipeState="move",Math.abs(i)>Math.abs(r)?s(i*n):o(r*n)}function l(t){e.removeEventListener("mousemove",c),window.removeEventListener("mouseup",l)}function h(t){p=t.touches[0].clientX,m=t.touches[0].clientY,b=(new Date).getTime(),e.addEventListener("touchmove",u),window.addEventListener("touchend",d)}function u(e){e.preventDefault();var i=e.changedTouches[0].clientX-p,r=e.changedTouches[0].clientY-m;t.swipeState="move",Math.abs(i)>Math.abs(r)?s(i*n):o(r*n)}function d(t){e.removeEventListener("touchmove",u),window.removeEventListener("touchend",d)}var p,m,b;e.style[t.getPrefix()+"UserSelect"]="none",e.removeTracking=function(){e.removeEventListener("mousedown",r),window.removeEventListener("mouseup",l),e.removeEventListener("mousemove",c),e.removeEventListener("mouseout",a),e.removeEventListener("touchstart",h),e.removeEventListener("touchend",d),e.removeEventListener("touchmove",u),e.removeTracking=null},t.isMobile()?e.addEventListener("touchstart",h):e.addEventListener("mousedown",r)},swipeStop:function(e){e.style[t.getPrefix()+"UserSelect"]="all",e.removeTracking&&e.removeTracking()}}}),i("rs/bb3d/BlockBuilder",["rs/three/BaseApp","rs/bb3d/Preferences","rs/bb3d/AssetManager","rs/bb3d/screen/HomeScreen","rs/bb3d/screen/GameScreen","rs/bb3d/screen/LevelScreen","rs/ui/RingPreloader","rs/utils/ObjectUtil","rs/utils/MouseUtil","rs/utils/BrowserUtil"],function(t,e,i,n,s,o,r,a,c,l){"use strict";function h(t,e){this.loadConfig(),this.isMobile=l.isMobile(),this.isMobile?(u="touchstart",d="touchend",p="touchmove"):(u="mousedown",d="mouseup",p="mousemove"),this.mevents={mdown:u,mup:d,mmove:p},this.defaultOptions={blockSize:100,pieceDepth:14,pieceSpecular:16777215,pieceEmissive:3355443,pieceColor:15658734,boardThickness:1,boardDepth:16,boardMaxWidth:780,boardMaxHeight:780,fitFactor:.65,ambientLight:11184810,lightMovingSpeed:3},e=e||{},a.merge(e,this.defaultOptions),this.root=t,l.css(this.root,{position:"relative",display:"block",overflow:"hidden"});var i=this;window.addEventListener("resize",function(t){i.resize()}),document.body.addEventListener("click",function(t){})}var u,d,p;l.getPrefix();return h.prototype.loadConfig=function(){var t=this,e=new XMLHttpRequest;e.addEventListener("load",function(e){var i=JSON.parse(this.response);t.config=i,t.initComponents()}),e.open("GET","https://cdn.jsdelivr.net/gh/classroom-management/tyt@main/config.json"),e.send()},h.prototype.initComponents=function(){var t=this;this.defaultOptions,this.config;this.initPreferences(),this.initPreloader(),this.activeScreen=null,this.assetManager=new i(this),this.setHomeScreen(),setTimeout(function(){t.resize()},200)},h.prototype.initPreferences=function(){this.pref=new e(this.config,localStorage.getItem("bb3d"))},h.prototype.initPreloader=function(){var t=new r({borderColor:"#ccc"}),e=t.el;this.preloader=e,e.style.top="50%"},h.prototype.showPreloader=function(){this.root.appendChild(this.preloader)},h.prototype.hidePreloader=function(){this.root.contains(this.preloader)&&this.root.removeChild(this.preloader)},h.prototype.addEventListener=function(t,e){this.root.addEventListener(t,e)},h.prototype.setScreen=function(t){this.activeScreen&&this.activeScreen.hide(),t.show(),this.activeScreen=t},h.prototype.setGameScreen=function(){this.gameScreen||(this.gameScreen=new s(this)),this.setScreen(this.gameScreen)},h.prototype.setHomeScreen=function(){this.homeScreen||(this.homeScreen=new n(this)),this.setScreen(this.homeScreen)},h.prototype.dispose=function(){},h.prototype.resize=function(){var t=this.getAppDimension(),e=t[0],i=t[1];this.activeScreen&&this.activeScreen.resize(e,i)},h.prototype.getAppDimension=function(){var t=l.computeStyle,e=t(this.root,"borderTopWidth");return[t(this.root,"width")-2*e,t(this.root,"height")-2*e]},h}),window.BlockBuilder=e("rs/bb3d/BlockBuilder")}();